{'eval_loss': 1.3783589601516724, 'eval_model_preparation_time': 0.0045, 'eval_runtime': 4.3378, 'eval_samples_per_second': 46.106, 'eval_steps_per_second': 11.527}
shots num: 0



 90%|█████████████████████████████████████████████████████████████████████████████████████████████▌          | 9/10 [00:07<00:00,  1.22it/s]
whole acc=0.0
fin_tok_acc=0.0
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:08<00:00,  1.21it/s]
 40%|█████████████████████████████████████████▌                                                              | 8/20 [00:00<00:01,  9.82it/s]
te_val_acc=0.988
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:02<00:00,  9.79it/s]

 50%|████████████████████████████████████████████████████▌                                                    | 1/2 [00:01<00:01,  1.98s/it]
test val_ds
mk_node_acc=0.95
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.91s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  5.74it/s]

 50%|████████████████████████████████████████████████████▌                                                    | 1/2 [00:01<00:01,  1.83s/it]
icl_acc=0.06
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.83s/it]




 80%|███████████████████████████████████████████████████████████████████████████████████▏                    | 8/10 [00:07<00:01,  1.07it/s]
whole acc=0.528
fin_tok_acc=0.536
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:09<00:00,  1.07it/s]
 25%|██████████████████████████                                                                              | 5/20 [00:01<00:03,  4.53it/s]
Traceback (most recent call last):
  File "/mnt/bn/videonasi18n/yutong/Fragmented-at-Training-Chained-at-Testing/main.py", line 203, in <module>
    do_test(My_Goal_graph, Model, Tokenizer, Test_max_examples, Test_len, logger)
  File "/mnt/bn/videonasi18n/yutong/Fragmented-at-Training-Chained-at-Testing/utils.py", line 253, in do_test
    te_val_accs = goal_graph.test_te_val_accs(test_len, model, i, 1000, tokenizer)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/bn/videonasi18n/yutong/Fragmented-at-Training-Chained-at-Testing/data_structure_related/data_structure.py", line 718, in test_te_val_accs
    outputs = model.generate(prompts, max_new_tokens=1, pad_token_id=tokenizer.eos_token_id, attention_mask=attention_masks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tiger/.local/lib/python3.11/site-packages/transformers/generation/utils.py", line 2255, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
KeyboardInterrupt