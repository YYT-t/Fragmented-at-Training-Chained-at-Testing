{'eval_loss': 1.3783589601516724, 'eval_model_preparation_time': 0.0048, 'eval_runtime': 4.3243, 'eval_samples_per_second': 46.25, 'eval_steps_per_second': 11.563}
shots num: 0



 90%|█████████████████████████████████████████████████████████████████████████████████████████████▌          | 9/10 [00:07<00:00,  1.25it/s]
whole acc=0.0
fin_tok_acc=0.0
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:08<00:00,  1.24it/s]
 45%|██████████████████████████████████████████████▊                                                         | 9/20 [00:00<00:01,  9.81it/s]
te_val_acc=0.988
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:02<00:00,  9.80it/s]

 50%|████████████████████████████████████████████████████▌                                                    | 1/2 [00:01<00:01,  2.00s/it]
test val_ds
mk_node_acc=0.95
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.93s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  5.74it/s]

 50%|████████████████████████████████████████████████████▌                                                    | 1/2 [00:01<00:01,  1.76s/it]
icl_acc=0.06
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.75s/it]




 90%|█████████████████████████████████████████████████████████████████████████████████████████████▌          | 9/10 [00:07<00:00,  1.14it/s]
whole acc=0.528
fin_tok_acc=0.536
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:08<00:00,  1.13it/s]

 75%|█████████████████████████████████████████████████████████████████████████████▎                         | 15/20 [00:02<00:00,  5.44it/s]
te_val_acc=0.922
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.44it/s]

 50%|████████████████████████████████████████████████████▌                                                    | 1/2 [00:02<00:02,  2.21s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.13s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.20it/s]
mk_node_acc=1.0
mk_val_acc=1.0

 50%|████████████████████████████████████████████████████▌                                                    | 1/2 [00:02<00:02,  2.07s/it]
icl_acc=0.99
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.06s/it]




 90%|█████████████████████████████████████████████████████████████████████████████████████████████▌          | 9/10 [00:08<00:00,  1.02it/s]
whole acc=0.728
fin_tok_acc=0.736

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:09<00:00,  1.02it/s]
  0%|                                                                                                                | 0/20 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/mnt/bn/videonasi18n/yutong/Fragmented-at-Training-Chained-at-Testing/main.py", line 203, in <module>
    do_test(My_Goal_graph, Model, Tokenizer, Test_max_examples, Test_len, logger)
  File "/mnt/bn/videonasi18n/yutong/Fragmented-at-Training-Chained-at-Testing/utils.py", line 253, in do_test
    te_val_accs = goal_graph.test_te_val_accs(test_len, model, i, 1000, tokenizer)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/bn/videonasi18n/yutong/Fragmented-at-Training-Chained-at-Testing/data_structure_related/data_structure.py", line 718, in test_te_val_accs
    outputs = model.generate(prompts, max_new_tokens=1, pad_token_id=tokenizer.eos_token_id, attention_mask=attention_masks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tiger/.local/lib/python3.11/site-packages/transformers/generation/utils.py", line 2255, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
KeyboardInterrupt